# RAG 시스템 토큰 비용 분석

## 현재 설정 vs 문맥 단위 비교

### 현재 설정 (문단 단위)
- 청크 크기: 500자
- 겹치기: 50자  
- 검색 결과: 5개 청크 (기본값)
- 총 텍스트: 2,500자 ≈ 1,250-1,670 토큰

### 문맥 단위 전략 (변경 후)
- 청크 크기: 1,500자 (3배 증가)
- 겹치기: 200자 (4배 증가)
- 윈도우 전략: 앞뒤 1-2개 청크 포함
- 8K 토큰 한도 내에서 조율
- 총 텍스트: 6,000-8,000자 ≈ 3,000-5,300 토큰

## 토큰 계산 기준
- 한글 토큰 비율: 약 1토큰 = 1.5-2자
- OpenAI GPT-4o 모델 기준

## 비용 비교 (질의당)

### 현재 비용 (문단 단위)
- Input 토큰: ~2,000토큰 × $0.0025 = $0.005
- Output 토큰: ~500토큰 × $0.01 = $0.005
- **총 비용: ~$0.01 (약 13원)**

### 문맥 단위 비용 (변경 후)
- Input 토큰: ~5,000토큰 × $0.0025 = $0.0125
- Output 토큰: ~800토큰 × $0.01 = $0.008
- **총 비용: ~$0.02 (약 26원)**

## 권장 설정값

```python
chunk_size: int = 1500  # 현재 500 → 1500
overlap: int = 200      # 현재 50 → 200
window_size: int = 1    # 앞뒤 1개 청크씩 포함
max_chunks: int = 3     # 검색 결과 3개로 제한
```

## 예상 효과
- 비용: 2배 증가 (질의당 26원)
- 품질: 문맥 이해도 대폭 향상
- 응답 정확도: 크게 개선
- 더 풍부한 컨텍스트 정보 제공

## OpenAI 요금 정책 (GPT-4o)
- Input: $0.0025 per 1K tokens
- Output: $0.01 per 1K tokens

날짜: 2025-09-15